#!/bin/bash
echo "---> Installing application source..."

# Copia para um diretório com permissões adequadas
cp -Rf /tmp/src/. ${HOME}/src/ 2>/dev/null || :
cp -Rf /tmp/src/. /opt/app-root/src/ 2>/dev/null || :

echo "---> Installing Python dependencies..."
cd /opt/app-root/src

if [ -f "requirements.txt" ]; then
    pip install --user --no-cache-dir -r requirements.txt
else
    echo "WARNING: requirements.txt not found"
    pip install --user --no-cache-dir Flask psycopg2-binary
fi

echo "---> Fixing permissions..."
chmod -R g+rw /opt/app-root/src 2>/dev/null || :

echo "---> Application setup completed"